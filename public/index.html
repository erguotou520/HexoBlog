<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>大道至简</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="抛弃复杂的尘世，忘却周边的烦恼，回归书写和阅读，放空心灵，做一个简单的自己。">
<meta property="og:type" content="website">
<meta property="og:title" content="大道至简">
<meta property="og:url" content="http://blog.erguotou.me/index.html">
<meta property="og:site_name" content="大道至简">
<meta property="og:description" content="抛弃复杂的尘世，忘却周边的烦恼，回归书写和阅读，放空心灵，做一个简单的自己。">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="大道至简">
<meta name="twitter:description" content="抛弃复杂的尘世，忘却周边的烦恼，回归书写和阅读，放空心灵，做一个简单的自己。">
  
    <link rel="alternate" href="/atom.xml" title="大道至简" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
  

</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">大道至简</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">Less is more</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Zoeken"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://blog.erguotou.me"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-hexo-on-firebase" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/hexo-on-firebase.html" class="article-date">
  <time datetime="2016-07-25T06:38:24.000Z" itemprop="datePublished">2016-07-25</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/hexo-on-firebase.html">利用firebase打造极速静态博客</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>之前博客一直是做的动态的，后台页面，添加博文，然后保存后查看博文。但最近VPS感觉不稳定加之价格有点小高（主要是穷），打算将vps上的所有东西都放在云端，使用免费资源（还不是因为穷）。第一步就是从博客开始。</p>
<h3 id="Hexo介绍"><a href="#Hexo介绍" class="headerlink" title="Hexo介绍"></a>Hexo介绍</h3><p><code>Hexo</code>是由台湾的一名大学生创建的静态博客系统，它基于’NodeJs’，生成文章的速度非常快，这也是为什么选择它的原因。当然还有很多其它的系统，但是作为<code>NodeJs</code>阵营的我当然是选择它啦。</p>
<h3 id="Hexo项目搭建"><a href="#Hexo项目搭建" class="headerlink" title="Hexo项目搭建"></a>Hexo项目搭建</h3><p>首先，安装<a href="https://hexo.io/zh-cn/docs/index.html">官方文档</a>过一遍，在本地安装搭建一个<code>Hexo</code>项目，例如我的<code>HexoBlog</code>。<br>这时运行<code>hexo server</code>并打开浏览器访问<code>http://localhost:4000</code>应该就可以访问到你搭建后的博客了，如果没有，请仔细阅读文档，重来一遍。<br>这里我稍微修改了下<code>_config.yml</code>文件，然后添加了deploy模块<br><figure class="highlight yaml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="attr">deploy:</span></div><div class="line"><span class="attr">  type:</span> git</div><div class="line"><span class="attr">  repo:</span> https://github.com/erguotou520/HexoBlog.git</div><div class="line"><span class="attr">  branch:</span> gh-pages</div></pre></td></tr></table></figure></p>
<p>这样以后deploy后的<code>public</code>文件夹里的内容会自动提交到<code>gh-pages</code>分支下。</p>
<h3 id="数据迁移"><a href="#数据迁移" class="headerlink" title="数据迁移"></a>数据迁移</h3><p>最开始的博客是在<code>Ghost</code>上跑的，后来又是用的<code>pagekit</code>，到现在的<code>Hexo</code>，每次数据迁移都是手动复制粘贴，太麻烦了，即使它们可能提供了一些迁移工具，但是还是会存在不靠谱的情况，所以还是手动复制吧。<br>这里要提到<code>Hexo</code>的一个好处了，文章是以<code>markdown</code>格式的文件存储，而不是存在数据库中，对于我们是可视的，再配合上后面的git，可以实现文章的历史管理。</p>
<h3 id="结合Github"><a href="#结合Github" class="headerlink" title="结合Github"></a>结合Github</h3><p>本地环境搭建好了之前就开始将它推送到github了，为什么放在github？一来是有个存储的地方，二来自带历史版本管理，三来可以实现自动化。<br>首先，添加hexo的git deploy插件。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install hexo-deployer-git --save</div></pre></td></tr></table></figure></p>
<p>接着在项目中添加一些必要的文件，因为<code>Hexo</code>的生成器并没有生成这些文件和内容。</p>
<ol>
<li>添加<code>.gitignore</code>，把<code>node_modules</code>和<code>.deploy_git</code>添加进来，后者是在添加<code>hexo-deployer-git</code>插件并执行<code>hexo deploy</code>命令时会生成。</li>
<li>补充<code>package.json</code>文件，可以加上<code>description</code>等其它字段，可选</li>
<li>添加<code>README.md</code>说明文件，可选</li>
</ol>
<p>OK，完成后开始推送。这个时候已经实现了hexo和github的结合，但是现在，每次添加完文章后都需要手动执行<code>hexo generate</code>和<code>hexo deploy</code>，是否可以更简单呢？</p>
<h3 id="与Travis结合"><a href="#与Travis结合" class="headerlink" title="与Travis结合"></a>与Travis结合</h3><p>我们可以利用<code>TravisCI</code>的自动化测试来进行自动构建任务。网上也有很多介绍<code>Hexo</code>+<code>Github</code>的文章，简单来说，就是在项目根目录下添加<code>.travis.yml</code>，内容如下<br><figure class="highlight yaml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"><span class="attr">language:</span> node_js</div><div class="line"></div><div class="line"><span class="attr">node_js:</span></div><div class="line"><span class="bullet">  -</span> <span class="string">"6"</span></div><div class="line"></div><div class="line"><span class="attr">branches:</span></div><div class="line"><span class="attr">  only:</span></div><div class="line"><span class="bullet">    -</span> master</div><div class="line"></div><div class="line"><span class="attr">before_install:</span></div><div class="line"><span class="bullet">  -</span> npm install hexo-cli -g</div><div class="line"><span class="bullet">  -</span> git config --global push.default matching</div><div class="line"><span class="bullet">  -</span> git config --global user.name <span class="string">"erguotou"</span></div><div class="line"><span class="bullet">  -</span> git config --global user.email <span class="string">"erguotou525@gmail.com"</span></div><div class="line"><span class="bullet">  -</span> sed -i<span class="string">''</span> <span class="string">"/^ *repo/s~github\.com~$&#123;ACCESS_TOKEN&#125;@github.com~"</span> _config.yml</div><div class="line"></div><div class="line"><span class="attr">install:</span></div><div class="line"><span class="bullet">  -</span> npm install</div><div class="line"></div><div class="line"><span class="attr">script:</span></div><div class="line">  <span class="comment"># - git submodule init      # 用于更新主题</span></div><div class="line">  <span class="comment"># - git submodule update</span></div><div class="line"><span class="bullet">  -</span> hexo clean</div><div class="line"><span class="bullet">  -</span> hexo d -g</div><div class="line"></div><div class="line"><span class="attr">cache:</span></div><div class="line"><span class="attr">  directories:</span></div><div class="line"><span class="bullet">    -</span> node_modules</div></pre></td></tr></table></figure></p>
<p>其中<code>{ACCESS_TOKEN}</code>就是下文要介绍的token。</p>
<p>接着在github中生成一个用于自动提交用的token。点击github中头像–&gt;’Settings’–&gt;<code>Personal access tokens</code>–&gt;<code>Generate new token</code>生成一个给travis用的token（权限我只勾选了repo相关的）。<br>因为github提供了中使用token进行push的方式，这也是我为什么<code>_config.yml</code>文件中<code>deploy</code>模块用的repo是https地址的原因了。<br>生成token后将其添加到travis的环境变量中<code>ACCESS_TOKEN</code>=token。<br>最后提交所有文件，等待<code>TravisCI</code>的构建结果，此时应当完成了与<code>TravisCI</code>结合的功能，如果构建报错，请具体结合报错内容修改。</p>
<h3 id="与Firebase结合"><a href="#与Firebase结合" class="headerlink" title="与Firebase结合"></a>与Firebase结合</h3><p>说到现在，我们都还没提到我们的主角<code>Firebase</code>。对于还不了解Firebase的同学建议先去看下网上的介绍。Firebase为我们提供了实时的云端存储和并提供全球CDN服务，我就是要利用它的CDN服务将我们的静态博客挂在CDN上。<br>首先，全局安装它的cli工具<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install -g firebase-tools</div></pre></td></tr></table></figure></p>
<p>然后登录firebase<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"># 不带参数会登录报错</div><div class="line"># 如遇到翻墙问题请自行解决</div><div class="line">firebase login --no-localhost</div></pre></td></tr></table></figure></p>
<p>接着进入项目根目录，执行<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">firebase init</div></pre></td></tr></table></figure></p>
<p>安装提示完成初始化，Firebase会自动在项目根目录下创建<code>firebase.json</code>文件，我们保证<code>firebase.json</code>里的<code>public</code>值为<code>public</code>即可，因为<code>public</code>文件夹是<code>hexo</code>生成的博客的目录。<br><figure class="highlight json"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="attr">"hosting"</span>: &#123;</div><div class="line">    <span class="attr">"public"</span>: <span class="string">"public"</span></div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>此时执行<code>firebase deploy</code>就可以将我们的博客推送上去了。但是我们需要结合<code>TravisCI</code>实现自动部署，所以在<code>.travis.yml</code>中添加firebase的自动部署模块<br><figure class="highlight yaml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="attr">after_success:</span></div><div class="line"><span class="bullet">  -</span> firebase deploy --token $&#123;FIREBASE_TOKEN&#125;</div></pre></td></tr></table></figure></p>
<p>其中<code>FIREBASE_TOKEN</code>是让<code>TravisCI</code>进行部署时的密钥，它需要我们通过下面的命令来生成<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">firebase login:ci --no-localhost</div></pre></td></tr></table></figure></p>
<p>登录验证成功后会得到一个token，复制它，在travis中添加环境变量<code>FIREBASE_TOKEN</code>，<code>value</code>为刚复制的token。<br>最后git提交推送，travis自动构建，firebase自动部署，OK，完美。</p>
<h3 id="Firebase自定义域名"><a href="#Firebase自定义域名" class="headerlink" title="Firebase自定义域名"></a>Firebase自定义域名</h3><p>默认firebase会为我们提供一个域名访问地址，但我们一般会用自己的域名来访问。此时按照Firebase Hosting的文档提示，在我们的域名中添加2个txt记录完成域名拥有权的验证，验证完成后等待firebase颁发https证书（我睡了一晚，醒来之后就好了），最后按照提示，将我们自己的域名做一个cname，解析到firebase给我们提供的域名上就可以啦。</p>
<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>本文介绍了Hexo+Github+TravisCI+Firebase搭建一个免费的拥有https的全球cdn加速的静态博客，综合利用了现有的网上资源，整个搭建过程会遇到各种问题，但都被一一解决。当然，Hexo作为静态博客，也会有一些不足，但这些不足我们都可以使用插件系统来实现，这也是后面要做的内容。<br>后面打算利用Firebase的database功能实现一个简单的博客评论系统，然后是定义一个自己用的主题，默认的太难看啦。后面的还有很长的一段路要走呢～</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://blog.erguotou.me/hexo-on-firebase.html" data-id="cir25r4qm000h30seahsfy4ve" class="article-share-link">Delen</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Firebase/">Firebase</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Github/">Github</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Hexo/">Hexo</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/TravisCI/">TravisCI</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-raspberry-pi-samba" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/raspberry-pi-samba.html" class="article-date">
  <time datetime="2016-06-07T13:32:12.000Z" itemprop="datePublished">2016-06-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/raspberry-pi-samba.html">闲置树莓派捣腾记</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>手上有一个树莓派，之前装个<code>openelec</code>看看视频什么的，后来因为一些原因废弃了。本来打算做私有云的，但是树莓派做私有云可能有些力不从心，等安定了后再捣腾私有云吧，到时可能黑群晖，也可能白群晖，也可能其它方案，都还不一定呢。现在先拿来玩耍玩耍做个共享弄个开源<code>ownCloud</code>还是可以的。废话不多说，进入正题。</p>
<h2 id="安装系统"><a href="#安装系统" class="headerlink" title="安装系统"></a>安装系统</h2><ol>
<li>使用<code>SDFormat</code>格掉SD卡。</li>
<li>使用<code>Win32 Disk Imager</code>将img镜像写入SD卡。这2步都在Win主机上执行，因为快，这也是为什么不推荐使用<code>NOOBS</code>安装的原因，太慢了。</li>
<li>卸下SD卡，装在我们的树莓派上，其它电源、网线、键鼠、显示器都接上。键鼠和显示器不是必须，但是有时为了方便会接上，而且刚进入系统用界面看IP地址也比较方便。</li>
<li>开机，点亮。</li>
<li>简单配置。如果是用<code>NOOBS</code>安装的系统，这步可以跳过。进入系统界面后，打开控制台，运行<code>sudo raspi-config</code>进入配置页面。选择第一个<code>Expand Filesystem</code>，将SD卡里的剩余空间全部扩充上。完成后可能要求重启。</li>
</ol>
<h2 id="调教系统"><a href="#调教系统" class="headerlink" title="调教系统"></a>调教系统</h2><ol>
<li>更新源。参考<a href="https://lug.ustc.edu.cn/wiki/mirrors/help/raspbian">科大的帮助页</a>。如果需要更新已有软件，可以使用<code>sudo apt-get upgrade</code>。</li>
<li>静态IP。网上关于更改<code>/etc/network/interfaces</code>文件的方法我试了，没用（<code>jessie</code>版本开始不能用此方法了），在界面中也没找到网络设置的位置。不过可以使用这种方法： <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">sudo nano /etc/dhcpcd.conf</div><div class="line"># 在配置文件最后加上</div><div class="line">interface eth0</div><div class="line">static ip_address=192.168.1.200</div><div class="line">static routers=192.168.1.1</div><div class="line">static domain_name_servers=114.114.114.114</div></pre></td></tr></table></figure>
</li>
</ol>
<p>改完后记得重启下。</p>
<ol>
<li>安装<code>samba</code>。不知道是因为执行过<code>apt-get upgrade</code>的原因还是什么，在安装时会出现依赖冲突，不能安装的情况。最后参考<a href="http://askubuntu.com/questions/222658/samba-installation-failed-on-ubuntu-12-10">http://askubuntu.com/questions/222658/samba-installation-failed-on-ubuntu-12-10</a> 里面介绍的方法解决的。首先执行 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo apt-get install --fix-broken &amp;&amp; sudo apt-get autoremove &amp;&amp; sudo apt-get update &amp;&amp; sudo apt-get install samba</div></pre></td></tr></table></figure>
</li>
</ol>
<p>失败，然后卸载。<br>    <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo apt-get remove samba-common libwbclient0 tdb-tools`，卸载完成后重新安装`sudo apt-get install samba samba-common-bin</div></pre></td></tr></table></figure></p>
<ol>
<li>配置<code>samba</code>。参照<a href="http://www.dreamxu.com/raspberrypi-nas/">http://www.dreamxu.com/raspberrypi-nas/</a> 。先备份配置 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo cp /etc/samba/smb.conf /etc/samba/smb.conf.bak</div></pre></td></tr></table></figure>
</li>
</ol>
<p>然后修改配置文件<code>sudo vim /etc/samba/smb.conf</code>并删除默认的<code>home</code>共享。<br>    <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">[share]</div><div class="line">    comment = Raspberry smb</div><div class="line">    path = /home/pi/share</div><div class="line">    browseable = yes</div><div class="line">    writeable = yes</div><div class="line">    create mask = 0664</div><div class="line">    directory mask = 0775</div></pre></td></tr></table></figure></p>
<p>为了简单，此处直接使用已有的<code>pi</code>用户。在<code>/home/pi</code>下新建<code>share</code>目录。完成后重启<code>samba</code>服务<code>sudo service samba restart</code>。到此就完成了<code>samba</code>的安装配置，可以在设备上拷贝文件测试了。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://blog.erguotou.me/raspberry-pi-samba.html" data-id="cir25r4rf000s30se8zvxv1q7" class="article-share-link">Delen</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Raspberry/">Raspberry</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-atom-frontend-plugins" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/atom-frontend-plugins.html" class="article-date">
  <time datetime="2016-05-22T10:05:18.000Z" itemprop="datePublished">2016-05-22</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/atom-frontend-plugins.html">Atom前端开发配置</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="Atom开发插件集合"><a href="#Atom开发插件集合" class="headerlink" title="Atom开发插件集合"></a>Atom开发插件集合</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line">apm list</div><div class="line">Community Packages (28) /Users/erguotou/.atom/packages</div><div class="line">├── Stylus@3.0.0</div><div class="line">├── atom-beautify@0.29.7</div><div class="line">├── atom-material-ui@1.2.11</div><div class="line">├── autoclose-html@0.23.0</div><div class="line">├── caniuse@0.9.0</div><div class="line">├── color-picker@2.1.1</div><div class="line">├── docblockr@0.7.3</div><div class="line">├── editorconfig@1.4.1</div><div class="line">├── emmet@2.4.3</div><div class="line">├── file-icons@1.7.12</div><div class="line">├── git-history@3.2.0</div><div class="line">├── git-plus@5.13.4</div><div class="line">├── javascript-snippets@1.2.1</div><div class="line">├── language-gitignore@0.2.0</div><div class="line">├── language-vue@0.12.0</div><div class="line">├── linter@1.11.4</div><div class="line">├── linter-eslint@7.2.2</div><div class="line">├── linter-htmlhint@1.1.4</div><div class="line">├── local-history@3.2.3</div><div class="line">├── minimap@4.24.0</div><div class="line">├── minimap-highlight-selected@4.4.0</div><div class="line">├── pigments@0.26.3</div><div class="line">├── platformio-ide-terminal@2.0.10</div><div class="line">├── rest-client@1.1.0</div><div class="line">├── svg-preview@0.7.4</div><div class="line">├── todo-show@1.6.0</div><div class="line">├── vue-autocomplete@0.1.0</div><div class="line">└── vue-snippets@0.6.0</div><div class="line"></div><div class="line">└── (empty)</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">apm install Stylus atom-beautify atom-material-ui autoclose-html caniuse color-picker docblockr editorconfig emmet file-icons git-history git-plus javascript-snippets language-gitignore language-vue linter linter-eslint linter-htmlhint local-history minimap minimap-highlight-selected pigments platformio-ide-terminal rest-client svg-preview todo-show vue-autocomplete vue-snippets</div></pre></td></tr></table></figure>
<h2 id="UI配置"><a href="#UI配置" class="headerlink" title="UI配置"></a>UI配置</h2><p>安装的是<code>atom-material-ui</code>主题，在mac上很多地方行高很高，需要修改其配置文件</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://blog.erguotou.me/atom-frontend-plugins.html" data-id="cir25r4oz000030sen7ml97bx" class="article-share-link">Delen</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Atom/">Atom</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Atom-plugin/">Atom-plugin</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-nodejs-share" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/nodejs-share.html" class="article-date">
  <time datetime="2016-04-26T12:50:25.000Z" itemprop="datePublished">2016-04-26</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/nodejs-share.html">NodeJs分享</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="Nodejs分享"><a href="#Nodejs分享" class="headerlink" title="Nodejs分享"></a>Nodejs分享</h1><p><em>技术分享以及项目实践</em></p>
<h2 id="目录"><a href="#目录" class="headerlink" title="目录"></a>目录</h2><ul>
<li>起源</li>
<li>特性</li>
<li>发展</li>
<li>影响</li>
<li>安装</li>
<li>生态圈</li>
<li>项目应用</li>
</ul>
<h2 id="起源"><a href="#起源" class="headerlink" title="起源"></a>起源</h2><h3 id="Nodejs是什么？"><a href="#Nodejs是什么？" class="headerlink" title="Nodejs是什么？"></a>Nodejs是什么？</h3><ul>
<li>服务器端运行的 Javascript</li>
<li>基于 Google Chrome的javascript engine V8</li>
<li>事件驱动，无阻塞 Evented,no-blocking</li>
<li>扩展js语义：增加了模块化</li>
<li>大约有8000行 c/c++代码，2000行 js 代码</li>
</ul>
<p>另外这里有一篇在线的文章<a href="http://book.51cto.com/art/201311/417099.htm">深入浅出Node.js</a>可以参阅。</p>
<h3 id="特性"><a href="#特性" class="headerlink" title="特性"></a>特性</h3><ul>
<li>支持高并发</li>
<li>异步io</li>
</ul>
<h3 id="发展"><a href="#发展" class="headerlink" title="发展"></a>发展</h3><h4 id="Nodejs版本"><a href="#Nodejs版本" class="headerlink" title="Nodejs版本"></a>Nodejs版本</h4><p>在和<code>io.js</code>合并之前一直维持着<code>0.x.x</code>版本，但是和<code>io.js</code>合并后就已经开始是<code>4.x.x</code>，<code>5.x.x</code>甚至<code>6.x.x</code>。</p>
<h3 id="影响"><a href="#影响" class="headerlink" title="影响"></a>影响</h3><p>由于js语法简单，掌握起来非常快，且大多数开发者都比较熟悉，所以上手很快。再加上有npm库的支持，使得nodejs开发也是很快，而且是越发展越迅猛的势头。它可以运用于许多场景，不仅仅是web开发，可以做桌面应用，手机App，可以命令行等等。  </p>
<ul>
<li>在web通讯中运用最广的应该是<code>socket.io</code>，它可以应用到web实时通讯，可以用于游戏通讯，可以用于在线开发工具通讯或者热重载等等。</li>
<li>在服务器领域最火的应该是<code>express</code>，用它开发web服务器非常快而且性能不错。</li>
<li>在用户身份认证方面使用最多的应该是<code>passport</code>，它为身份认证提供了统一的接口，支持本地身份认证和各种第三方身份认证。</li>
<li>在桌面应用开发方面有<code>nw.js</code>和<code>electron</code>，相对来说<code>electron</code>更好，而且Github官方出的开发工具<code>Atom</code>就是使用<code>electron</code>开发的。使用它们开发的工具还有很多，包括<code>slack</code> // todo</li>
<li>在手机App方向应用最火的、热度最高的应该算是<code>ionic</code>和<code>React Native</code>，前者借助于<code>Angularjs</code>和<code>PhoneGap</code>可以实现用js开发跨平台的手机应用。后者是Fackbook依赖于其<code>React</code>推出的手机应用开发套件，其火热程度非同一般。</li>
<li>其它更多的产品等你发现和分享。</li>
</ul>
<h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><p>Nodejs环境的安装方法各平台不一致，但都比较简单。非windows平台建议使用<code>nvm</code>进行nodejs的安装和版本管理。</p>
<h4 id="全局安装模块"><a href="#全局安装模块" class="headerlink" title="全局安装模块"></a>全局安装模块</h4><p>使用npm安装全局模块<code>npm install -g some-module</code></p>
<h4 id="本地安装"><a href="#本地安装" class="headerlink" title="本地安装"></a>本地安装</h4><p>使用npm安装本地模块<code>npm install some-module</code>，它有2个常用的参数<code>--save</code>和<code>--save-dev</code>，分别表示将该模块依赖信息保存到<code>package.json</code>的<code>dependencies</code>和<code>devDependencies</code>，分别表示运行时依赖和开发时依赖。这样项目发布出去后别人就可以通过<code>npm install --production</code>和<code>npm install</code>命令将依赖安装上。</p>
<h4 id="安装指定版本或指定tag"><a href="#安装指定版本或指定tag" class="headerlink" title="安装指定版本或指定tag"></a>安装指定版本或指定tag</h4><ul>
<li>安装指定版本 <code>npm install some-module@1.3.0</code></li>
<li>安装指定tag <code>npm install some-module#dev</code></li>
<li>更多其它的安装条件在这里不做说明</li>
</ul>
<h4 id="更新"><a href="#更新" class="headerlink" title="更新"></a>更新</h4><p>更新可以直接重新安装也可以使用update命令<code>npm update [-g] some-module</code></p>
<h4 id="卸载"><a href="#卸载" class="headerlink" title="卸载"></a>卸载</h4><p>对应于install命令有uninstall命令，使用方法和install一致<code>npm uninstall [-g] [--save|--save-dev]</code></p>
<h4 id="一些说明"><a href="#一些说明" class="headerlink" title="一些说明"></a>一些说明</h4><ul>
<li>npm的包大多是嵌套的，即包A依赖包B，包B又依赖包C，npm会处理所有的依赖关系并全部安装（npm 2和npm 3有所区别，npm 2是在每个包下安装其所有的依赖包，包括嵌套依赖，而npm 3会先分析包的依赖关系，将依赖扁平化，减少重复依赖）</li>
<li>由于国内网络管制原因，可能有些包在安装时会出现失败，如果出现失败，建议使用国内npm源，比如cnpm等。个人喜欢使用<code>nrm</code>进行管理</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">npm install -g nrm</div><div class="line">nrm ls</div><div class="line">nrm use taobao # 这里使用的是淘宝源</div></pre></td></tr></table></figure>
<h3 id="生态圈"><a href="#生态圈" class="headerlink" title="生态圈"></a>生态圈</h3><p>Nodejs的生态圈主要靠npm(node package manager)。这里面有成千上万的工具，每天更新的包数量就有//todo<br>当我们需要使用node开发某些功能时要善用npm，因为它里面已经有很多现成的包，不需要我们重复造轮子，直接拿来用就可以了。<br>我们可以通过npm search或者去<a href="https://npmjs.org">npm官网</a>搜索，输入关键词，找到包后查看其说明，如果是我们想要的，那就<code>npm install</code>它吧。</p>
<h3 id="项目应用"><a href="#项目应用" class="headerlink" title="项目应用"></a>项目应用</h3><p>此次精总前端项目就大量使用了Nodejs的相关技术。</p>
<ul>
<li>包安装。使用npm（npm也是很多前端库文件的发布目录，bower等已经不适合现在的趋势）将项目使用的框架文件安装到本地并使用node的文件模块将其复制到我们的项目目录中（多这一步是因为我们没有采用开发时编译的思路，因为这对框架的搭建和开发学习的成本要求较高）</li>
<li><code>gulp</code>任务。使用<code>gulp</code>添加开发时任务<code>gulp dev</code>，包括代码风格检查和预编译语言的实时编译以及浏览器自动重载等。还有其它的包括js文档生成任务和文档查看服务器任务等。</li>
<li>源代码的构建。使用nodejs生态圈中的构建工具对源码进行构建，生成服务发布的目录文件，主要是对代码进行合并压缩和版本控制。</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://blog.erguotou.me/nodejs-share.html" data-id="cir25r4qu000l30sejzxzxi2x" class="article-share-link">Delen</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/NodeJs/">NodeJs</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-git-migration" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/git-migration.html" class="article-date">
  <time datetime="2016-04-12T07:32:00.000Z" itemprop="datePublished">2016-04-12</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/git-migration.html">Git迁移记录</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h2><p>之前公司的Git服务器是用的<a href="https://gogs.io/">Gogs</a>，当时安装时选择的是<code>tidb</code>数据库。后来发现<code>tidb</code>数据库无法使用<code>ssh</code>服务（更改为其它数据库是可以的），但是我们的开发过程中有很多命令行的一些操作，导致每次使用命令时都需要输入用户名和密码，很麻烦，所以想改下数据库，然后使用<code>ssh://</code>格式的Git仓库。</p>
<h2 id="尝试"><a href="#尝试" class="headerlink" title="尝试"></a>尝试</h2><p>第一次是打算从<code>Gogs</code>入手，但是<code>Gogs</code>并不提供数据迁移的能力。<br>后来准备从数据库角度出发，备份之前的数据库和仓库。仓库备份很简单，但是数据库是<code>tidb</code>采用了<code>xorm</code>库封装的，没有启动服务，所以没法用mysql客户端连接。<br>再后来准备尝试用<code>xorm</code>库提供的方法新建个工程然后把数据备份出来，奈何需要学习<code>Go</code>语言，而且好多不会玩，后来还是没有尝试了。<br>也找过DBA帮我看下，无果…  </p>
<h2 id="现行解决方案"><a href="#现行解决方案" class="headerlink" title="现行解决方案"></a>现行解决方案</h2><p>现在采用的解决方案虽然有点麻烦，但好歹也是可行的。首先重新建个<code>Gogs</code>的服务，初始化安装（这次选择的是<code>sqlite</code>，因为那台服务器上没有mysql，也就懒得装了），重新建立组织和空仓库，建用户。然后通过clone之前的仓库并添加新的仓库地址最后push的方式来完成的。理论虽然简单，但中间还是遇到了一些小问题，这里记录下。下面是shell脚本（参考了<a href="http://stackoverflow.com/questions/6865302/push-local-git-repo-to-new-remote-including-all-branches-and-tags">Push local Git repo to new remote including all branches and tags</a>）。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line">#!/bin/sh</div><div class="line">sourceProtocal=&apos;http://&apos;</div><div class="line">sourcePrefix=&apos;192.168.10.240:3000/&apos;</div><div class="line">targetPrefix=&apos;git@192.168.10.240:&apos;</div><div class="line">array=(</div><div class="line">  org/repo.git</div><div class="line">  org/repo1.git</div><div class="line">)</div><div class="line">for repository in $&#123;array[@]&#125;; do</div><div class="line">  # username是原仓库的用户名，password是原仓库的密码</div><div class="line">  source=$&#123;sourceProtocal&#125;username:password@$&#123;sourcePrefix&#125;$&#123;repository&#125;</div><div class="line">  target=$&#123;targetPrefix&#125;$&#123;repository&#125;</div><div class="line">  tmp=$&#123;repository##*/&#125;</div><div class="line">  dir=$&#123;tmp%.git*&#125;</div><div class="line">  git clone $&#123;source&#125;</div><div class="line">  cd $&#123;dir&#125;</div><div class="line">  git remote add target $&#123;target&#125;</div><div class="line">  for remote in `git branch -r | grep -v master `; do</div><div class="line">    git checkout --track remotes/$remote</div><div class="line">  done</div><div class="line">  # git push target &apos;*:*&apos;</div><div class="line">  git push target --all</div><div class="line">  git push target --tags</div><div class="line">  echo &apos;source &apos;$&#123;source&#125;&apos; clone OK.&apos;</div><div class="line">  cd ../</div><div class="line">done</div></pre></td></tr></table></figure></p>
<h2 id="添加ssh公钥"><a href="#添加ssh公钥" class="headerlink" title="添加ssh公钥"></a>添加ssh公钥</h2><p>ssh公钥是为了让我们和服务器通讯时免去输入用户名和密码的一种认证方式，详细可以查看<a href="https://wiki.archlinux.org/index.php/SSH_keys_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87">这篇文章</a>)，我们改成ssh方式后需要将我们电脑的公钥上传至<code>Gogs</code>才能实现无需密码的<code>push</code>操作。<br>1.生成公钥（已经生成过可以跳过）。如果电脑上安装了<code>Git</code>并且有<code>Git Bash</code>，那么可以打开<code>Git Bash</code>运行<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"># -C 后面的是注释，可不传</div><div class="line">ssh-keygen -t rsa -C &quot;youremail@xxx.com&quot;</div></pre></td></tr></table></figure></p>
<p>然后一路回车生成我们的公私钥，文件存放在<code>C:\Users\{your windows accoutn}\.ssh</code>。<br>如果该方法不适合你请自行百度生成ssh公钥。<br>2.上传我们的公钥。打开上面说的目录里面的<code>id_rsa.pub</code>文件，复制里面的所有内容。再打开<code>Gogs</code>服务的网址，登陆。<br>点击右上角头像，选择<code>用户设置</code>，选择<code>管理 SSH 密钥</code>，点击<code>增加密钥</code>。<code>密钥名称</code>处随便填写个，然后在<code>密钥内容</code>中粘贴我们前面复制的内容，点击下面的<code>增加密钥</code>按钮完成添加。</p>
<h2 id="工作副本的仓库地址修改"><a href="#工作副本的仓库地址修改" class="headerlink" title="工作副本的仓库地址修改"></a>工作副本的仓库地址修改</h2><p>1.进入原克隆的工作目录<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">cd /path/to/your/workspace</div></pre></td></tr></table></figure></p>
<p>2.查看原工作副本的远程地址<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git remote -v</div></pre></td></tr></table></figure></p>
<p>可以看到之前的地址是以<code>http://</code>开头的，我们需要修改其为新的<code>ssh://</code>方式。<br>3.修改地址<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git remote set-url origin &lt;git@192.168.10.240:org/repo.git&gt;</div></pre></td></tr></table></figure></p>
<p><code>org</code>和<code>repo</code>为上述<code>git remote -v</code>查看得到的组织名和仓库名，该地址也可以通过网页上复制得到<br><img src="/images/git/gogs-ssh.png" alt="Gogs ssh">。<br>一切OK！  </p>
<blockquote>
<p>如果有其它非origin远程，可以通过同样的方法修改仓库地址。</p>
</blockquote>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://blog.erguotou.me/git-migration.html" data-id="cir25r4rk000u30se1u9estml" class="article-share-link">Delen</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Git/">Git</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-play-video-while-downloading" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/play-video-while-downloading.html" class="article-date">
  <time datetime="2016-03-23T07:35:00.000Z" itemprop="datePublished">2016-03-23</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/play-video-while-downloading.html">mp4视频实现边下载边播放</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>在做视频播放时,出现了这样一个问题,就是网页上播放mp4视频时,必须要等到视频下载完成之后,才能播放,不能够随意拖拽,之后通过一个叫做ffmpeg的视频转码软件解决了这个问题.</p>
<p>1.软件地址:链接: <a href="http://pan.baidu.com/s/1qW2ZpJe">http://pan.baidu.com/s/1qW2ZpJe</a> 密码: 291n</p>
<p>2.windows下进入,通过cmd命令行进入该软件的目录bin文件夹下,然后,输入qt-faststart.exe 源文件.mp4 新文件.mp4 就会当前目录生成一个转过的mp4视频,</p>
<p>3.最后,视频要通过nginx服务器作为中转来实现在线播放,具体配置如下:</p>
<p>nginx服务器的root目录要改为具体的tomcat目录存放转换好了的视频资源路径,端口要改成一个不和tomcat冲突的端口号  </p>
<p>jsp视频播放页面,加载视频资源的时候访问的是nginx服务器(通过nginx的端口号来访问)不访问tomcat,访问nginx之后,然后nginx寻找资源从tomcat的静态资源存放路径中去读取事先上传过来的视频,当然如果你愿意把视频直接拷到nginx的默认根目录,也可以不需要改动nginx的conf配置文件的root目录<br>这里是当时jsp页面端的部分代码,nginx的端口号改的是8080,视频播放插件用的是ckplayer<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">//nginx服务器视频地址</div><div class="line">var path=location.protocol+&quot;//&quot;+window.location.host+&quot;:8080&quot;+&quot;$&#123;path&#125;&quot;;</div><div class="line">	var flashvars=&#123;</div><div class="line">		f:path,</div><div class="line">		c:0,</div><div class="line">		b:1</div><div class="line">		&#125;;</div><div class="line">var params=&#123;bgcolor:&apos;#FFF&apos;,allowFullScreen:true,allowScriptAccess:&apos;always&apos;,wmode:&apos;transparent&apos;&#125;;</div><div class="line">	CKobject.embedSWF(&quot;&lt;c:url value=&apos;/static/ckplayer6.4/ckplayer/ckplayer.swf&apos;/&gt;&quot;,&apos;a1&apos;,&apos;ckplayer_a1&apos;,&apos;800&apos;,&apos;470&apos;,flashvars,params);</div></pre></td></tr></table></figure></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://blog.erguotou.me/play-video-while-downloading.html" data-id="cir25r4qz000o30semqbpcu7y" class="article-share-link">Delen</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-ppt-online" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/ppt-online.html" class="article-date">
  <time datetime="2016-03-23T07:01:00.000Z" itemprop="datePublished">2016-03-23</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/ppt-online.html">ppt-online</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>在做科大学生骨干培训班这个项目时 ,由于需要用到在线浏览学生的ppt文件,为了实现这个问题,采用的解决方案是通过一个软件将其转换为flash进行播放.</p>
<p>软件准备:链接:<a href="http://pan.baidu.com/s/1sjv5DPb">http://pan.baidu.com/s/1sjv5DPb</a></p>
<p>解压之后,可以看到iSpring Presenter文件夹,iSpring Presenter 是以 PowerPoint 插件的形式工作的，下载解压后先运行 !)iSpringPresenterPortable.exe，选择安装后会自动添加插件，再打开 PowerPoint 就能看到了，支持 Microsoft PowerPoint 2003/2007/2010.</p>
<p>安装完毕之后,打开一个ppt文件,这时ppt菜单工具栏会出现一个iSpring Presenter工具选项,点击切换到该工具选项,点击publish按钮,弹出一个对话框,general选项卡有个Player Template,可以选择一个适合的播放器模板,还有就是选择生成路径,其他选项卡设置可以不动,点击弹出框的按钮publish即可.具体如下图<br><img src="/images/others/test.png" alt=""></p>
<p>完了之后生成一个文件,里面有swf文件以及js 和html文件,在实际应用中,把html和js文件写成jsp形式,然后把jsp文件里面引用swf的路径替换为从数据库读取的路径即可.</p>
<p>整个过程就是把ppt转swf文件,然后通过,软件提供的html和js整合一个公共的ppt在线播放页面,用来加载swf文件即可.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://blog.erguotou.me/ppt-online.html" data-id="cir25r4rm000x30se5f1gbhwf" class="article-share-link">Delen</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-vsftpd-config" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/vsftpd-config.html" class="article-date">
  <time datetime="2016-02-05T03:58:00.000Z" itemprop="datePublished">2016-02-05</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/vsftpd-config.html">vsftpd的安装配置</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<p>参考自<a target="_blank" href="http://www.cnblogs.com/whoamme/p/3494128.html">http://www.cnblogs.com/whoamme/p/3494128.html</a></p>
</blockquote>
<p>1.安装相关工具包<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">yum -y install pam vsftpd db4 db4-utils</div></pre></td></tr></table></figure></p>
<p>2.创建一个不能登录的用户，用作ftp服务的虚拟用户<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">useradd -d /home/xxx -s /sbin/nologin vuser_ftp</div></pre></td></tr></table></figure></p>
<p><code>/home/xxx</code>为用户根目录，<code>/sbin/nologin</code>指定用户不能使用shell，该账号不能用于登录系统<br>这里使用<code>vuser_ftp</code>作为虚拟用户的映射对象，在web服务器中可以使用<code>httpd</code><br>这个服务的用户来作为虚拟用的映射。比如<code>www apapche web</code>，没大明白~<br>3.创建一个记录ftp虚拟用户的用户名和密码文件，如<code>login.txt</code><br>第一行用户名，第二行密码，以此类推<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">vi /etc/vsftpd/login.txt</div><div class="line">user1</div><div class="line">pwd1</div><div class="line">user2</div><div class="line">pwd2</div></pre></td></tr></table></figure></p>
<p>4.使用db_load 命令生成虚拟用户认证文件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">db_load -T -t hash -f /etc/vsftpd/login.txt /etc/vsftpd/vsftpd_login.db</div></pre></td></tr></table></figure></p>
<p><code>vsftpd_login.db</code>文件是db_load命令生成的虚拟用户认证文件<br>5.备份vsftpd配置文件，再修改配置文件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line">vi /etc/vsftpd/vsftpd.conf</div><div class="line"></div><div class="line">anonymous_enable=NO</div><div class="line">local_enable=YES</div><div class="line">write_enable=YES</div><div class="line">local_umask=022</div><div class="line">dirmessage_enable=YES</div><div class="line">xferlog_enable=YES</div><div class="line">connect_from_port_20=YES</div><div class="line">xferlog_file=/var/log/vsftpd.log</div><div class="line">xferlog_std_format=YES</div><div class="line">listen=YES</div><div class="line">userlist_enable=YES</div><div class="line">tcp_wrappers=YES</div><div class="line">max_per_ip=5</div><div class="line">max_clients=100</div><div class="line"></div><div class="line">#### 下面是关于虚拟用户的配置</div><div class="line"></div><div class="line">guest_enable=YES #打开用户虚拟</div><div class="line">guest_username=vuser_ftp #将所有虚拟用户映射成vuer_ftp这个本地用户</div><div class="line">#此用户是之前新建的用户</div><div class="line">pam_service_name=ftp.vu #ftp用户的pam验证方式，默认是vsftpd，必须改掉。</div><div class="line">user_config_dir=/etc/vsftpd/vsftpd_user_conf #这里放置每个虚拟用户的配置文件</div></pre></td></tr></table></figure></p>
<p>6.创建vsftpd.conf中提到的验证文件<br>使用<code>rpm -ql vsftpd</code>这个命令查找验证模块的例文，找到如下一段<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">/usr/share/doc/vsftpd-2.2.2/EXAMPLE/VIRTUAL_USERS/vsftpd.pam</div></pre></td></tr></table></figure></p>
<p>将其拷贝到vsftpd.conf文件中配置的路径中并改变文件名<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">cp /usr/share/doc/vsftpd-2.2.2/EXAMPLE/VIRTUAL_USERS/vsftpd.pam /etc/pam.d/ftp.vu</div></pre></td></tr></table></figure></p>
<p>前面配置中的<code>pam_service_name=ftp.vu中ftp.vu</code>使用的是相对路径，绝对路径是<code>/etc/pam.d/ftp.vu</code></p>
<p>上面这条命令就是把vsftpd程序自带的关于pam认证的模板文件拷贝到<code>pam.d</code>这个服务的工作目录，同时改变文件名为<code>ftp.vu</code>。<br><code>/etc/pam.d/</code>目录下已经有了一个<code>vsftpd.pam</code>文件，现在要做的是让vsftpd虚拟用户的这个功能用到的一个特殊的pam认证。还要修改下<code>ftp.vu</code>这个文件</p>
<p>先来看下原文件的内容：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">vi /usr/share/doc/vsftpd-2.2.2/EXAMPLE/VIRTUAL_USERS/vsftpd.pam</div><div class="line"></div><div class="line">auth required /lib/security/pam_userdb.so db=/etc/vsftpd/login</div><div class="line">account required /lib/security/pam_userdb.so db=/etc/vsftpd/login</div></pre></td></tr></table></figure></p>
<p>将两处的<code>db=/etc/vsftpd/login</code>修改成<code>db=/etc/vsftpd/vsftpd_login</code>，文件都是以.db结尾的，但此处不要填写.db。同时由于我们的系统是64位的，还需要将配置中间的<code>/lib/</code>改为<code>/lib64/</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">vi /etc/pam.d/ftp.vu</div><div class="line"></div><div class="line">auth required /lib64/security/pam_userdb.so db=/etc/vsftpd/vsftpd_login</div><div class="line">account required /lib64/security/pam_userdb.so db=/etc/vsftpd/vsftpd_login</div></pre></td></tr></table></figure></p>
<p>7.创建<code>vsftpd.conf</code>中提到的虚拟用户配置目录<code>user_config_dir=/etc/vsftpd/vsftpd_user_conf</code>，以及在这个目录下面创建每个用户的权限配置文件<br>创建<code>/etc/vsftpd/vsftpd_user_conf</code>目录<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mkdir /etc/vsftpd/vsftpd_user_conf</div></pre></td></tr></table></figure></p>
<p>在<code>/etc/vsftpd/vsftpd_user_conf</code>目录下面分别创建之前在<code>login.txt</code>虚拟用户名和密码文件中提到的user1 user2 这两个虚拟用户的权限配置文件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">vi /etc/vsftpd/vsftpd_user_conf/user1</div><div class="line"></div><div class="line">anon_world_readable_only=no #用户可以浏览和下载文件，不能设为yes，否则无法看到文件</div><div class="line">write_enable=yes #用户可以创建文件</div><div class="line">anon_upload_enable=yes #用户可以上传文件</div><div class="line">anon_mkdir_write_enable=yes #用户有创建和删除目录的权限</div><div class="line">anon_other_write_enable=yes #用户具有文件改名和删除文件的权限</div><div class="line">local_root=/home/xxx #指定这个虚拟FTP用户的家目录。这里的xxx是你网站的根目录</div></pre></td></tr></table></figure></p>
<p>之后再创建user2的权限文件（略）<br>8.OK！结束！重启vsftpd服务<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">service vsftpd restart</div></pre></td></tr></table></figure></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://blog.erguotou.me/vsftpd-config.html" data-id="cir25r4rz001530selawi6z09" class="article-share-link">Delen</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/vsftpd/">vsftpd</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-ssh-via-public-key" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/ssh-via-public-key.html" class="article-date">
  <time datetime="2015-12-23T16:12:00.000Z" itemprop="datePublished">2015-12-24</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/ssh-via-public-key.html">服务器安全登录</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>搬瓦工的VPS要到期了，以前用着好难受的感觉，所以决定加点钱换个好点的，最后还是买了<code>Linode</code>。这里记录一下以一个更安全的方式连接VPS的设置过程。</p>
<h2 id="新建用户"><a href="#新建用户" class="headerlink" title="新建用户"></a>新建用户</h2><p>首先新建用户，不使用<code>root</code>用户登录<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">useradd -g root erguotou</div></pre></td></tr></table></figure></p>
<p>设置密码<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">passwd erguotou</div></pre></td></tr></table></figure></p>
<p>添加到<code>root</code>组（不确定该步骤是否必须）<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">vi /etc/sudoers</div></pre></td></tr></table></figure></p>
<p>找到<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">## Allow root to run any commands anywhere</div><div class="line">root    ALL=(ALL)     ALL</div></pre></td></tr></table></figure></p>
<p>在下面添加<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">erguotou ALL=(ALL)     ALL</div></pre></td></tr></table></figure></p>
<h2 id="使用公私钥方式登录"><a href="#使用公私钥方式登录" class="headerlink" title="使用公私钥方式登录"></a>使用公私钥方式登录</h2><p>首先退出<code>root</code>用户，使用新建的用户登录，然后在用户目录下新建<code>.ssh/authorized_keys</code>文件。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">mkdir ~/.ssh</div><div class="line">touch ~/.ssh/authorized_keys</div><div class="line">chmod 700 ~/.ssh</div></pre></td></tr></table></figure></p>
<p>然后复制本机的公钥内容添加到VPS的<code>authorized_keys</code>文件中，保存，退出登录，重新登录后就可以不用输入密码了。</p>
<h2 id="禁root禁密码登录"><a href="#禁root禁密码登录" class="headerlink" title="禁root禁密码登录"></a>禁root禁密码登录</h2><p>使用<code>root</code>用户执行<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">vi /etc/ssh/sshd_config</div></pre></td></tr></table></figure></p>
<p>找到<code>PasswordAuthentication</code>配置，并改为<code>no</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">PasswordAuthentication no</div></pre></td></tr></table></figure></p>
<p>找到<code>PermitRootLogin</code>配置，并改为<code>no</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">PermitRootLogin no</div></pre></td></tr></table></figure></p>
<p>最后退出当前用户登录，然后尝试使用<code>root</code>登录，再尝试是否可以用密码方式登录。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://blog.erguotou.me/ssh-via-public-key.html" data-id="cir25r4rv001430se8dnjppl3" class="article-share-link">Delen</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/SSH/">SSH</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-pretty-webfont" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/pretty-webfont.html" class="article-date">
  <time datetime="2015-11-15T11:00:00.000Z" itemprop="datePublished">2015-11-15</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/pretty-webfont.html">优秀Web字体收集</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <ul>
<li>InfoQ</li>
</ul>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">p</span>: &#123;</div><div class="line">  <span class="attribute">font-family</span>: <span class="string">'Lantinghei SC'</span>, <span class="string">'Open Sans'</span>, Arial, <span class="string">'Hiragino Sans GB'</span>, <span class="string">'Microsoft YaHei'</span>, 微软雅黑, STHeiti, <span class="string">'WenQuanYi Micro Hei'</span>, SimSun, Helvetica, sans-serif;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>Vue.js<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">p</span>: &#123;</div><div class="line">  <span class="attribute">font-family</span>: <span class="string">'Source Sans Pro'</span>, <span class="string">'Helvetica Neue'</span>, Arial, sans-serif;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://blog.erguotou.me/pretty-webfont.html" data-id="cir25r4rl000w30sea7c3gg5l" class="article-share-link">Delen</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Fonts/">Fonts</a></li></ul>

    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/2/">__('next') &raquo;</a>
  </nav>
</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Labels</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Api/">Api</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Atom/">Atom</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Atom-plugin/">Atom-plugin</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Firebase/">Firebase</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Fonts/">Fonts</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Frontend/">Frontend</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Ghost/">Ghost</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Git/">Git</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Github/">Github</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Hexo/">Hexo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Nginx/">Nginx</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/NodeJs/">NodeJs</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Raspberry/">Raspberry</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SSH/">SSH</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Swiftype/">Swiftype</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/TravisCI/">TravisCI</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Vps/">Vps</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vsftpd/">vsftpd</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/Api/" style="font-size: 10px;">Api</a> <a href="/tags/Atom/" style="font-size: 10px;">Atom</a> <a href="/tags/Atom-plugin/" style="font-size: 10px;">Atom-plugin</a> <a href="/tags/Firebase/" style="font-size: 10px;">Firebase</a> <a href="/tags/Fonts/" style="font-size: 10px;">Fonts</a> <a href="/tags/Frontend/" style="font-size: 10px;">Frontend</a> <a href="/tags/Ghost/" style="font-size: 20px;">Ghost</a> <a href="/tags/Git/" style="font-size: 16.67px;">Git</a> <a href="/tags/Github/" style="font-size: 10px;">Github</a> <a href="/tags/Hexo/" style="font-size: 10px;">Hexo</a> <a href="/tags/Nginx/" style="font-size: 10px;">Nginx</a> <a href="/tags/NodeJs/" style="font-size: 10px;">NodeJs</a> <a href="/tags/Raspberry/" style="font-size: 13.33px;">Raspberry</a> <a href="/tags/SSH/" style="font-size: 10px;">SSH</a> <a href="/tags/Swiftype/" style="font-size: 10px;">Swiftype</a> <a href="/tags/TravisCI/" style="font-size: 10px;">TravisCI</a> <a href="/tags/Vps/" style="font-size: 10px;">Vps</a> <a href="/tags/vsftpd/" style="font-size: 10px;">vsftpd</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archieven</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/07/">七月 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/06/">六月 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/05/">五月 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/04/">四月 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/03/">三月 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/02/">二月 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/12/">十二月 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/11/">十一月 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/08/">八月 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/07/">七月 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/04/">四月 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/03/">三月 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/02/">二月 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/01/">一月 2015</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recente berichten</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/hexo-on-firebase.html">利用firebase打造极速静态博客</a>
          </li>
        
          <li>
            <a href="/raspberry-pi-samba.html">闲置树莓派捣腾记</a>
          </li>
        
          <li>
            <a href="/atom-frontend-plugins.html">Atom前端开发配置</a>
          </li>
        
          <li>
            <a href="/nodejs-share.html">NodeJs分享</a>
          </li>
        
          <li>
            <a href="/git-migration.html">Git迁移记录</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2016 二锅头<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>